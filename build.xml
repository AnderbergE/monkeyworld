<project name="MonkeyWorld" default="compile">

	<property name="lib" value="lib" />
	<property name="source.dir" value="src" />
	<property name="build.dir" value="html" />
	<property name="aggregate.dir" value="." />

	<taskdef
		name="jscomp"
		classname="com.google.javascript.jscomp.ant.CompileTask"
		classpath="lib/closure/compiler.jar"/>

	<target name="aggregate" depends="make_test">
	    <concat destfile="${aggregate.dir}/aggregate.js">
	    	<filelist dir="${source.dir}" files="MW.js"/>
	        <fileset dir="${source.dir}" includes="**/*.js" excludes="MW.js" />
	    </concat>
	</target>
	
	<target name="make_test">
		<concat destfile="test/aggregate.js">
	    	<filelist dir="${source.dir}" files="MW.js"/>
			<fileset dir="${source.dir}" includes="**/*.js" excludes="Core.js,MW.js" />
		</concat>
	</target>
	
	<target name="html_uncompiled">
	
	</target>
	
	<target name="compile" depends="aggregate">
		<jscomp
			compilationLevel="advanced"
			debug="false"
			output="html/monkeyworld.js"
			warning="verbose">

			<externs dir=".">
				<file name="jquery-1.3.2.externs.js"/>
				<file name="externs.js"/>
			</externs>
			<sources dir="${aggregate.dir}">
				<file name="aggregate.js" />
			</sources>
		</jscomp>
		
		<copy todir="${build.dir}" file="${source.dir}/html/index.html" />
		<copy todir="${build.dir}" file="${source.dir}/html/style.css" />
	</target>

</project>
