var g=void 0,i=!0,o=null,p=!1;function q(){return function(){}}function r(c){return function(){return this[c]}}
function ba(){var c={},a=[],b=0;this.V=function(){return"GameEventManager"};this.on=function(a,b,d){for(var a=a.split(" "),h=0;h<a.length;h++)a[h]in c||(c[a[h]]=[]),c[a[h]].push(b),b.z=d,s.debug((d===g?"unnamed":d)+" registerd "+a[h],"evm")};this.off=function(a,b){for(var d=0;d<c[a].length;d++)c[a][d].z===b&&c[a].splice(d,1);0==c[a].length&&delete c[a]};this.print=function(){console.log("-------EVENT MANAGER STATE-----------------");for(var a in c){console.log("key: "+a);for(var b=0;b<c[a].length;b++)console.log("   "+
c[a][b].z)}console.log("-------------------------------------------")};this.m=function(f){if(0<b)a.push(f);else{var e=0,d;for(d in c){for(var h=0;h<c[d].length;h++)c[d][h].z===f&&(c[d].splice(h,1),e++);0==c[d].length&&delete c[d]}s.debug("Forgot "+e+" event registred by "+f,"evm")}};this.a=function(f,e,d){b++;f=c[f];if(f!=g)for(var h=0;h<f.length;h++){var k=f[h];d!=g&&d&&s.debug("      "+f[h].z);k(e)}b--;if(0==b&&0<a.length){for(h=0;h<a.length;h++)this.m(a[h]);a=[]}};this.qa=function(a,b,d){s.debug("Loading images...",
"view");var h=0,c=Object.size(a),j;for(j in a)b[j]=new Image,b[j].onload=function(){++h>=c&&d()},b[j].src="../res/img/"+a[j]}}
function z(){B.call(this);var c=this,a=o,b=10,f=o;this.ba=function(b){a.eb(b)};this.Q=function(){a.Q()};this.R=function(){0<b&&(b--,c.a(E,{ha:b},i));a.R()};this.ra=function(){return a.ra()};this.D=function(){return a};this.ma=function(){return b};this.hb=function(){s.debug("Round done","game");this.a("Game.roundDone");this.a("Game.nextRound");this.b.ab()};this.play=function(d,e){b=10;c.a(E,{ha:b},i);a=new ca;console.log(this.i);f=new d.u[this.i](this,e);this.start()};var e=p,d=p;this.M=function(){e=
i;f.G();c.b.wa()};this.gb=function(){e=p;c.b.va();f.fb()};this.j=function(){return e};this.Wa=function(){d=i;c.b.wa()};this.Xa=function(){d=p;c.b.va()};this.f=function(){return d};this.stop=function(){this.a("Game.roundDone")}}G(z,B);z.prototype.onFrame=q();function da(){this.play=function(){throw"No implemented mini game";}}da.prototype=new z;
function H(){J.call(this);var c=this.d.p;(function(a){var b=new Kinetic.Text({text:"Backend Score (current mode):",fontSize:16,fontFamily:"sans-serif",textFill:"black",align:"left",verticalAlign:"middle",x:a.d.getWidth()-500,y:15});c.add(b);a.on(E,function(a){b.setText("Backend Score (current mode): "+a.ha)});a.on(L,function(){c.remove(b)})})(this)}G(H,J);var O=p,L="tearDown",E="backendScoreUpdateMode";Kinetic.Y=q();Kinetic.Y.getWidth=q();
function P(c){this.i=c;this.on=function(a,b,c){this.k.on(a,b,c===g?this.i:c)};this.off=function(a,b){this.k.off(a,b===g?this.i:b)};this.m=function(a){this.k.m(a===g?this.i:a)};this.a=function(a,b,c){c!=g&&c&&s.debug("Out: "+a,this.i);this.k.a(a,b,c)};this.V=function(){console.log(this.k.V())};this.w=function(a){this.i=a}}P.prototype.k=new function(){this.V=function(){return"NoEventManager"};this.on=q();this.a=q();this.off=q();this.m=q()};P.prototype.d=new Kinetic.Y;P.prototype.b=o;
function ea(){var c=[];this.ta=function(a){c.push(a)};this.D=function(a){var b=a-1;if(0>b||b>=c.length)throw"MonkeyWorld.NoSuchRoundException ("+a+")";return c[b]}}function ca(){var c=p,a=[];this.R=function(){s.debug("Got mistake report","game");c=i};this.ra=function(){return c};this.eb=function(b){a.push(b)};this.Q=function(){a.splice(a.length-1)};this.la=function(){return a}}
function fa(){this.ta=function(){throw"MonkeyWorld.NoMiniGameResultException";};this.D=function(){throw"MonkeyWorld.NoMiniGameResultException";}}function ga(){}ga.prototype.name=function(){return"Regular"};function ha(){this.start=q();this.l=q();this.onFrame=q();this.la=q()}
function B(){P.call(this,"Module");var c=this,a=new function(){var a=[];this.setTimeout=function(c,e){var d=setTimeout(c,e);a.push(d);return d};this.setInterval=function(c,e){var d=setTimeout(c,e);a.push(d);return d};this.clearTimeout=function(c){a.remove(c);clearTimeout(c)};this.U=function(){for(var c=0;c<a.length;c++)clearTimeout(a[c]);delete a;a=[]}};this.l=function(){s.debug("Tearing down","Module");a.U();c.a(L)};this.setTimeout=function(b,c){return a.setTimeout(b,c)};this.setInterval=function(b,
c){return a.setInterval(b,c)};this.clearTimeout=function(b){a.clearTimeout(b)}}G(B,P);var ia=o;window.egame=o;window.onload=function(){ia=new ja;window.egame=ia};WebFontConfig={google:{families:["Nunito::latin","Doppio+One::latin","Nobile:400,700:latin"]}};var Q=document.createElement("script");Q.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";Q.type="text/javascript";Q.async="true";var ka=document.getElementsByTagName("script")[0];
ka.parentNode.insertBefore(Q,ka);
function ja(){function c(){k.a("Game.loadingSounds");var a=o,d=o;s.debug("Loading sounds...","game");var c=new PreloadJS(p);c.onComplete=function(){clearInterval(a);d=setInterval(function(){k.a("Game.updateImageLoading",{progress:la.Ua()})},50);s.debug("Sounds loaded.","game");k.a("Game.loadingImages");la.qa(function(){clearInterval(d);k.a("Game.updateImageLoading",{progress:1});s.debug("Images loaded.","game");setTimeout(function(){k.a("Game.loadingDone");h.start()},O?0:1E3)})};c.installPlugin(SoundJS);
a=setInterval(function(){k.a("Game.updateSoundLoading",{progress:c.progress})},50);R.lb(b);c.loadManifest(R.Va())}var a=new ma;S.kb();this.applySettings=function(){a.apply();$.cookie("monkeyWorldSettings",JSON.stringify(S.N()))};this.hideSettings=function(){a.hide()};this.showSettings=function(){a.show()};var b=new Kinetic.Stage({container:"container",width:1024,height:768});b.q=b.getWidth()/1024;var f=new Kinetic.Layer,e=new Kinetic.Layer,d=new Kinetic.Layer;b.add(f);b.add(e);b.add(d);b.La=f;b.p=
e;b.aa=d;b.Oa=e;b.Jc=r("p");b.Ic=r("La");b.Kc=r("aa");b.J=p;b.Fc=0;b.Dc=0;b.s=function(){b.J=i};var h=new na(b,i,!O),k=h.k,j=new ha,n=function(){var a=0,b=new Kinetic.Text({text:"",fontFamily:"Arial",textFill:"black",textStroke:"white",textStrokeWidth:1,fontSize:18,x:0,y:0});e.add(b);return{nb:function(d){if(0==a||10<d.time-a)b.setText("FPS: "+Math.round(1E3/d.timeDiff)),a=d.time}}}();b.onFrame(function(a){O&&n.nb(a);k.a("frame",{frame:a});j.onFrame(a);e.draw();b.J&&(d.draw(),b.J=p);Tween.tick(a.timeDiff,
p)});b.start();k.on("Game.miniGameListenersInitiated Game.viewInitiated",function(){e.moveToTop();d.moveToTop()},"game");f=O?0:2E3;k.a("Game.showLoadingScreen",{time:f});setTimeout(function(){c()},f);this.ua=function(){h.ua()}}function U(){}U.prototype=new P("Player");U.prototype.u=q();
var S=new function(){var c={global:{language:{e:"en"},monkeySeeRounds:{e:1},triesBeforeGuardianAngel:{e:3}},miniGames:{fishingGame:{targetNumber:{e:2},numberCorrect:{e:1},numberOfFish:{e:7},maxNumber:{e:9}},ladder:{targetNumber:{e:-1}}}};this.N=function(){return c};this.get=function(a){for(var b=c,f=0;f<arguments.length;f++)b=b[arguments[f]];return b.e};this.set=function(a){for(var b=c,f=0;f<arguments.length-1;f++)b=b[arguments[f]];b.e=arguments[arguments.length-1]};this.kb=function(){var a=JSON.parse($.cookie("monkeyWorldSettings"));
a!==o&&(c=a)};this.jb=function(a,b){for(var f=a.split("-"),e=c,d=0;d<f.length;d++)e=e[f[d]];e.e=b}};
function ma(){function c(a,b){for(var d in a)if("object"===typeof a[d]&&a[d].e===g)c(a[d],b+"-"+d);else if(a[d].e!=g){var e=$("#"+b+"-"+d).val();S.jb(b+"-"+d,e)}}function a(){$("#settings-panel").append('<div id="settings-panel-content">');d=$("#settings-panel-content");d.append("<h1>"+V.get("SETTINGS_LABEL")+"</h1>");d.append("<form>");var a=e.N(),c;for(c in a)d.append(f(c,2,"")),d.append(b(a[c],2,c));d.append("<button type=\"button\" onclick=\"window['egame']['hideSettings']()\">"+V.get("SETTINGS_CANCEL")+
"</button>");d.append("<button type=\"button\" onclick=\"window['egame']['applySettings']();window['egame']['hideSettings']()\">"+V.get("SETTINGS_APPLY")+"</button>");d.append("</form>");d.append("</div>")}function b(a,d,c){var e;e="<ul>";for(var l in a)if("object"===typeof a[l]&&a[l].e===g)e+=f(l,d+1,c),e+=b(a[l],d+1,c+"-"+l);else{e+="<li>";e+=f(l,d+1,c);var m="",m=m+('<input type="text" id="'+(c+"-"+l)+'" value="'+a[l].e+'" />');e+=m+"</li>"}return e+"</ul>"}function f(a,b,d){var c="",a="SETTINGS_"+
((d===g?"":d+"_")+a).toUpperCase().replace("-","_")+"_LABEL",a=V.get(a);a!=o&&(c+="<h"+b+">"+a+"</h"+b+">");return c}var e=S,d=$("#settings-panel-content");this.apply=function(){var b=e.N(),f;for(f in b)"object"===typeof b[f]&&c(b[f],f);d.remove();a()};this.show=function(){a();$("#settings-panel").show()};this.hide=function(){d.remove();$("#settings-panel").hide()}}function G(c,a){function b(){}b.prototype=a.prototype;c.Lc=a.prototype;c.prototype=new b}
Object.size=function(c){var a=0,b;for(b in c)c.hasOwnProperty(b)&&a++;return a};var s=new function(){function c(a,b,c){c===g&&(c="");if("evm"!=c&&"sound"!=c){for(var c=c.substr(0,8),c=c.toUpperCase(),e=8-c.length,d=0;d<e;d++)c=" "+c;console.log(a+" "+c+" "+b)}}console.log("Creating Log");this.debug=function(a,b){c("DEBUG  ",a,b)};this.cb=function(a){c("NOTIFY ",a,"sound")};this.error=function(a,b){c("ERROR  ",a,b)}};Array.prototype.remove=function(c){for(var a=0;a<this.length;a++)this[a]===c&&this.splice(a)};
var W=new function(){function c(a,b,c,e){var d=0,h=0;this.next=function(){var k=a+d*c,j=b+h*e;d=(d+1)%2;0==d&&h++;return{x:k,y:j}}}this.S=function(a,b){a.x!=g&&(a.x*=b);a.y!=g&&(a.y*=b);a.width!=g&&(a.width*=b);a.height!=g&&(a.height*=b);a.fontSize!=g&&(a.fontSize*=b);if(a.scale!=g&&(a.scale.x!=g&&(a.scale.x*=b),a.scale.y!=g))a.scale.y*=b;return a};this.C=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};this.Za=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return i;return p};this.F=
function(a,b,f,e){return new c(a,b,f,e)}};
function J(){function c(){a.Ya();a.m();a.l!=g&&a.l()}s.debug("Creating ViewModule","object");B.call(this);var a=this,b=new function(){var a=[];this.c=function(b){W.Za(a,b)||a.push(b);return Tween.get(b)};this.removeTweens=function(a){Tween.removeTweens(a)};this.U=function(){for(var b=0;b<a.length;b++)Tween.removeTweens(a[b])}};this.Na=function(){this.on("Game.stopMiniGame",function(){c()});this.on("Game.roundDone",function(){c()})};this.c=function(a){return b.c(a)};this.t=function(a){b.removeTweens(a)};
var f=this.l;this.l=function(){s.debug("Tearing down","ViewModule");e.hide();f();b.U()};var e=function(){var b=o;return{hide:function(){b!=o&&(b.setText(""),a.d.s())},show:function(c){b!=o?(b.moveTo(a.d.p),a.d.s(),b.setText(c),b.setPosition(a.d.attrs.width/2,150*a.d.q)):(b=new Kinetic.Text({x:a.d.attrs.width/2,y:150,text:c,fontSize:26,fontFamily:"Short Stack",textFill:"white",textStroke:"black",align:"center",verticalAlign:"middle",scale:{x:0.001,y:0.001},textStrokeWidth:1}),W.S(b,a.d.q));a.d.p.add(b);
Tween.get(b.attrs.scale).to(W.S({x:2,y:2},a.d.q),1E3).wait(3E3).call(function(){Tween.get(b.attrs.scale).to(W.S({x:1,y:1},a.d.q),1E3).call(q());Tween.get(b.attrs).to({y:50*a.d.q},1E3).call(function(){b.moveTo(a.d.aa);a.d.s()})})}}}();this.mb=function(){e.show("YAY!")};this.Ya=function(){e.hide()};this.getStage=r("d")}G(J,B);J.prototype.d=o;
Kinetic.ub=function(c){var a=new Kinetic.Group({x:c.x,y:c.y,width:c.width,height:c.height}),b=new Kinetic.Rect({x:0,y:0,width:c.width,height:c.height,fill:"#ccc",strokeWidth:1,stroke:"white"}),f=new Kinetic.Text({text:c.text,fontFamily:"Arial",textFill:"black",fontSize:c.fontSize,x:c.width/2,y:c.height/2,verticalAlign:"middle",align:"center"});a.add(b);a.add(f);a.on("mousedown touchstart",c.callback);return a};
function oa(c){B.call(this);var a=[X.X,X.Ha,X.Ea,X.Fa];this.Ta=function(){return a};this.Qa=function(a){c(a)}}G(oa,B);
function na(c,a,b,f){function e(){m.a("Game.stopMiniGame");x.stop();delete x;v=0;x=F;m.a("miniGameDone")}function d(){m.k.print();K();if(a){A.prototype.A=H.prototype.A;var b=l(A,x);b.Na();b.H();m.a("Game.miniGameListenersInitiated")}m.a("Game.initiate");m.a("miniGameInitiated");"Monkey Do"===t?x.play(C,M.D(N).la()):x.play(C);m.a("Game.start",{},i);m.a("miniGameStarted",{},i)}function h(a){f===g?m.a("Game.showMiniGameChooser",{callback:function(b){K=function(){m.a("Game.hideMiniGameChooser");console.log("NYTT SPEL");
x=l(b.b);A=b.view};a()},Sa:T}):(K=function(){x=l(T[f].b);console.log("NYTT SPEL "+x.ma());A=T[f].view},a())}function k(){if("Child Play"===t)t="Monkey See",d();else if("Monkey See"===t){var a=x.D();M.ta(a);t="Monkey Do";C=I;d()}else"Monkey Do"===t&&(N===S.get("global","monkeySeeRounds")?(n(1),t="Child Play",C=w,e(),h(function(){d()})):(n(N+1),d()))}function j(a){console.log("setMinigameScore"+a);v=a;console.log("setMinigameScore"+v);m.a("backendScoreGameUpdateMiniGame",{ib:v})}function n(a){if(a>
S.get("global","monkeySeeRounds")&&("Monkey See"===t||"Monkey Do"===t))throw"MonkeyWorld.MiniGameRoundOverMaxLimit";if(1>a)throw"MonkeyWorld.MiniGameRoundUnderMinLimit";N=a}function l(a,b){a.prototype.k=m.k;a.prototype.b=m;a.prototype.d=c;var d=o;return d=b===g?new a:b!=g?new a(b):new a(b,g,g,g)}var m=this;this.k=new ba;this.d=c;this.b=this;var F=new da,u=new fa,w=l(pa),I=l(qa),D=new ga,t="Child Play",x=F,A=o,K=o,C=w,N=1,M=u,v=0,T={tree:{title:"Tree Game",view:ra,b:sa},mountain:{title:"Mountain Game",
view:ta,b:sa}};a===g&&(a=i);b===g&&(b=i);a&&l(ua);this.ab=function(){if(x===F)throw"MonkeyWorld.NoActiveMiniGameException";this.a("Game.stopMiniGame",{},i);j(v+x.ma());k()};this.start=function(){function c(b){H.prototype.A=b;M=new ea;C=w;a&&l(va);h(function(){j(0);m.a("learningTrackUpdate",{$a:D});d()})}var e=o;b?(e=l(oa,function(a){e.l();c(a)}),a&&(l(wa,e).H(),m.a("Game.viewInitiated"))):c(X.X)};this.stop=function(){e();t="Child Play";n(1);C=w;M=u;this.a("Game.stop")};this.ua=function(){this.stop();
this.start()};this.va=function(){C=I};this.wa=function(){C=w};this.sa=function(){return C===w};this.P=function(){return C===I};this.bb=function(){return"Child Play"===t};this.r=function(){return"Monkey See"===t};this.g=function(){return"Monkey Do"===t}}na.prototype=new P("MonkeyWorld.Game");
function sa(){function c(a){d.a("Ladder.getTarget",{callback:function(){d.a("Ladder.resetScene",{callback:a},O);d.a("Ladder.hasTarget",{},O)},K:p},O)}function a(){k=W.C(1,6);d.a("Ladder.placeTarget",{callback:function(){d.a("Ladder.readyToPick",{},O)}},O)}function b(a){return function(){e();a?(l=i,c(function(){d.ba("correct");l=p})):d.a("Ladder.resetScene",{callback:function(){d.R();d.a("Ladder.incorrect");4<=I&&d.a("Ladder.agentSuggestSolution");d.ba("incorrect")},K:i})}}function f(a){m=i;d.b.g()&&
!d.j()?d.a("Ladder.allowInterrupt",{callback:a}):a()}function e(){m=p;d.b.g()&&d.a("Ladder.disallowInterrupt")}z.call(this);var d=this;this.w("Ladder");var h=Array(6);S.get("miniGames","ladder","targetNumber");for(var k=W.C(1,6),j=0,n=0,l=p,m=p,F=1,u=0;6>=F;F+=1)h[u++]=F;this.O=function(){n++;d.a("Ladder.confirmTarget",{callback:function(){3===n||3<=j&&1<=n?d.a("Ladder.cheer",{callback:function(){d.hb()}},O):a()}},O)};var w=0,I=0;this.n=function(a){j++;f(function(){d.a("Ladder.picked",{o:a,Hc:a===
k,callback:function(){d.f()?I++:I=0;d.f()&&a===k&&d.Xa();d.a("Ladder.approachLadder",{o:a,callback:function(){b(a===k)();a<k&&(d.b.g()&&!d.j()&&!d.f())&&d.a("Ladder.agentTooLow");a>k&&(d.b.g()&&!d.j()&&!d.f())&&d.a("Ladder.agentTooHigh");a<k&&(d.b.r()||d.j()||d.f())&&d.a("Ladder.tooLow");a>k&&(d.b.r()||d.j()||d.f())&&d.a("Ladder.tooHigh")}},O);a===k&&(a<w&&(d.j()||d.f()))&&d.a("Ladder.betterBecauseSmaller");a===k&&(a>w&&(d.j()||d.f()))&&d.a("Ladder.betterBecauseBigger");a!=k&&(d.j()||d.f())&&d.a("Ladder.hmm");
d.b.g()&&(w=a);var c=d.f()&&a===k;(d.b.g()&&!d.f()||c)&&d.gb()}},O)})};this.L=function(){return k};this.na=function(){var a=W.C(0,h.length-1);return h[a]===k?this.na():h[a]};this.B=function(){return h};var D=this.M;this.M=function(){m&&d.b.P()&&(e(),D(),d.Q(),l||(d.a("Ladder.interrupt"),d.a("Ladder.resetScene",{callback:q()})))};this.start=function(){d.a("Ladder.start");d.b.r()?d.a("Ladder.introduceAgent",{callback:a}):d.b.g()?d.a("Ladder.startAgent",{callback:a}):a()}}G(sa,z);
var xa={X:"monkey.png",Ba:"balloons.png",W:"BeOS_Eyeball.png",Ja:"Symbol-Stop.png",Ia:"Symbol-Check.png",Ca:"Birds-Nest-psd47561.png",Ga:"Jungle_Bkg.png",Ea:"elephant.png",Ha:"lion.png",Fa:"giraff.png"},X={},la=function(){var c={},a=0,b=0,f;for(f in X)a++;c.Ua=function(){return b};c.qa=function(c){s.debug("Loading images...","images");var d=0,h=Object.size(xa),f;for(f in xa){var j=xa[f];X[f]=new Image;X[f].onload=function(){++d>=h&&c();b=d/a};X[f].src="../res/img/"+j}};return c}();
function Y(c,a,b){this.I=c;this.v=a;this.pa=b}
var ya=new Y("27882__stickinthemud__bike-horn-double-toot",o),za=new Y("60443__jobro__tada1",o),Aa=new Y("406__tictacshutup__click-1-d",o,4),Ba=new Y(o,"NO_MY_TURN"),Ca=new Y(o,"THANKS_FOR_CHOOSING_ME"),Da=new Y(o,"BUT_YOU_CAN_INTERRUPT"),Ea=new Y(o,"IM_GOING_TO_PICK_THIS_ONE"),Fa=new Y(o,"MAYBE_THAT_WORKS"),Ga=new Y(o,"WHICH_ONE_DO_YOU_THINK_IT_IS"),Ha=new Y(o,"LADDER_LOOKS_FUN"),Ia=new Y(o,"LADDER_SHOW_ME"),Ja=new Y(o,"LADDER_MY_TURN"),Ka=new Y(o,"LADDER_PLEASE_HELP_ME"),La=new Y(o,"LADDER_TREE_OOPS_TOO_HIGH"),
Ma=new Y(o,"LADDER_TREE_OOPS_TOO_LOW"),Na=new Y(o,"LADDER_TREE_TRY_A_SMALLER_NUMBER"),Oa=new Y(o,"LADDER_TREE_TRY_A_BIGGER_NUMBER"),Pa=new Y(o,"LADDER_TREE_AGENT_SUGGEST_SOLUTION_1"),Qa=new Y(o,"LADDER_TREE_AGENT_SUGGEST_SOLUTION_2"),Ra=new Y(o,"LADDER_TREE_BETTER_BECAUSE_BIGGER"),Sa=new Y(o,"LADDER_TREE_BETTER_BECAUSE_SMALLER"),Ta=new Y(o,"LADDER_TREE_AGENT_PLAY_TOO_LOW"),Ua=new Y(o,"LADDER_TREE_AGENT_PLAY_TOO_HIGH"),Va=new Y(o,"LADDER_TREE_AGENT_SEE_CORRECT"),Wa=new Y(o,"LADDER_MOUNTAIN_IM_DOWN_HERE"),
Xa=new Y(o,"LADDER_MOUNTAIN_IM_UP_HERE"),Ya=new Y(o,"LADDER_MOUNTAIN_TRY_FEWER_BALLOONS"),Za=new Y(o,"LADDER_MOUNTAIN_TRY_MORE_BALLOONS"),$a=new Y(o,"LADDER_MOUNTAIN_AGENT_SUGGEST_SOLUTION_1"),ab=new Y(o,"LADDER_MOUNTAIN_AGENT_SUGGEST_SOLUTION_2"),bb=new Y(o,"LADDER_MOUNTAIN_BETTER_BECAUSE_BIGGER"),cb=new Y(o,"LADDER_MOUNTAIN_BETTER_BECAUSE_SMALLER"),db=new Y(o,"LADDER_MOUNTAIN_AGENT_PLAY_TOO_LOW"),eb=new Y(o,"LADDER_MOUNTAIN_AGENT_PLAY_TOO_HIGH"),fb=new Y(o,"LADDER_MOUNTAIN_AGENT_SEE_CORRECT"),gb=
new Y(o,"LADDER_MOUNTAIN_YOU_SAVED_ME"),hb=new Y(o,"LADDER_MOUNTAIN_IM_HUNGRY"),ib={Bc:new Y("19446__totya__yeah","YAY"),qb:ya,xc:za,vb:Aa,wc:Ba,yc:Ca,tb:Da,Kb:Ea,Cc:new Y(o,"YES_I_THINK_THAT_ONE_IS_BETTER"),rc:Fa,Ac:Ga,tc:new Y(o,"MONKEY_HMM"),qc:new Y("51710__bristolstories__u-chimes3_short",o),Ob:Ha,dc:Ia,bc:Ja,Mb:new Y(o,"LADDER_IS_IT_RIGHT"),Nb:new Y(o,"LADDER_IT_WAS_RIGHT"),cc:Ka,Lb:new Y(o,"LADDER_AGENT_HELP_IN_INTERRUPT"),lc:La,mc:Ma,oc:Na,nc:Oa,hc:Pa,ic:Qa,jc:Ra,kc:Sa,fc:Ta,ec:Ua,gc:Va,Wb:Wa,
Yb:Xa,Zb:Ya,$b:Za,Sb:$a,Tb:ab,Ub:bb,Vb:cb,Qb:db,Pb:eb,Rb:fb,ac:gb,Xb:hb,NUMBER_1:new Y(o,"NUMBER_1"),NUMBER_2:new Y(o,"NUMBER_2"),NUMBER_3:new Y(o,"NUMBER_3"),NUMBER_4:new Y(o,"NUMBER_4"),NUMBER_5:new Y(o,"NUMBER_5"),NUMBER_6:new Y(o,"NUMBER_6"),NUMBER_7:new Y(o,"NUMBER_7"),NUMBER_8:new Y(o,"NUMBER_8"),NUMBER_9:new Y(o,"NUMBER_9"),NUMBER_10:new Y(o,"NUMBER_10"),pb:new Y(o,"ARE_YOU_READY_TO_TEACH"),Jb:new Y(o,o,2),Cb:new Y(o,"FISHING_FREE_WRONG_ONES"),zb:new Y(o,"FISHING_CATCH"),Eb:new Y(o,"FISHING_NOT_THIS_ONE"),
Hb:new Y(o,"FISHING_THERE_ARE_MORE"),Db:new Y(o,"FISHING_KEEP_GOING"),yb:new Y(o,"FISHING_ARE_YOU_SURE"),Ab:new Y(o,"FISHING_COUNT_FISH"),Bb:new Y(o,"FISHING_COUNT_TARGET_FISH"),Ib:new Y(o,o),Fb:new Y(o,o),Gb:new Y(o,o),wb:new Y(o,"FISHING_ANGEL_CHOOSE_FISH"),xb:new Y(o,"FISHING_ANGEL_COUNT"),sb:new Y(o,"BUBBA_HI"),rb:new Y(o,"BUBBA_HERE_TO_HELP"),uc:new Y(o,"MONKEY_LEARNED_WELL"),sc:new Y(o,"MONKEY_DIDNT_LEARN_WELL"),pc:new Y(o,"LETS_SHOW_HIM_AGAIN"),zc:new Y(o,"THANK_YOU_FOR_HELPING"),vc:new Y(o,
"NOW_MONKEY_SHOW_YOU")},R=function(){function c(a){for(var b=0;b<e.length;b++)e[b].attrs.y-=30;e.push(a)}var a={},b=o,f=o,e=[],d=o;a.lb=function(a){b=a;f=b.Oa};a.Va=function(){if(d===o){d=[];for(var a in ib){var b=ib[a];ib[a].$=a;if(b.I!=o){var c={id:a,src:"../res/sound/"+b.I+".ogg|../res/sound/"+b.I+".mp3"};b.pa!=g&&(c.data=b.pa);d.push(c)}}}return d};a.play=function(a){s.cb('"'+a.v+'"');a.I!=o&&SoundJS.play(a.$);var d=V.get(a.v);d!=o&&(a.v=d);if(a.v!=o){var j=new Kinetic.Text({x:f.getParent().attrs.width/
2,y:f.getParent().attrs.height-50,text:a.v,fontSize:26,fontFamily:"Nobile",textFill:"white",fill:"black",stroke:"black",strokeWidth:15,textStroke:"black",align:"center",verticalAlign:"middle",textStrokeWidth:1});c(j);f.add(j);b.s();setTimeout(function(){f.remove(j);b.s();for(var a=0;a<e.length;a++)e[a]===j&&e.splice(a,1)},3E3)}};a.stop=function(a){SoundJS.stop(a.$)};return a}(),V=function(){var c={INIT_LOADING_SOUNDS:{sv:"Laddar ner ljud...",en:"Downloading sounds..."},INIT_LOADING_IMAGES:{sv:"Laddar ner bilder...",
en:"Downloading images..."},RESTART:{sv:"Starta om",en:"Restart"},SETTINGS:{sv:"Inst\u00e4llningar",en:"Settings"},YAY:{sv:"Hurra!",en:"Yay!"},THANKS_FOR_CHOOSING_ME:{sv:"Ja! Tack f\u00f6r att du valde mig!",en:"Yay! Thanks for choosing me!"},ARE_YOU_READY_TO_TEACH:{sv:"\u00c4r du redo att l\u00e4ra apan?",en:"Are you ready to teach monkey?"},NO_MY_TURN:{sv:"Gl\u00f6m inte att det \u00e4r MIN tur nu!",en:"Remember it\u2019s MY turn now!"},BUT_YOU_CAN_INTERRUPT:{sv:"Men du kan avbryta mig om jag g\u00f6r fel.",
en:"But you can interrupt me if I'm making a mistake."},MAYBE_THAT_WORKS:{sv:"Okej, vi testar och ser om det \u00e4r r\u00e4tt.",en:"OK, let's see if this works."},WHICH_ONE_DO_YOU_THINK_IT_IS:{sv:"Vilken tror du att det \u00e4r?",en:"Which one do you think it is?"},YES_I_THINK_THAT_ONE_IS_BETTER:{sv:"Ja, det d\u00e4r fungerar nog b\u00e4ttre!",en:"Yes, I think that one is better!"},LADDER_TREE_BETTER_BECAUSE_BIGGER:{sv:"Ja, det verkar vara ett bra val, eftersom den \u00c4R st\u00f6rre!",en:"Yes, that seems to be a good choice because it IS bigger!"},
LADDER_TREE_BETTER_BECAUSE_SMALLER:{sv:"Ja, det verkar vara ett bra val, eftersom den \u00c4R mindre!",en:"Yes, that seems to be a good choice because it IS smaller!"},IM_GOING_TO_PICK_THIS_ONE:{sv:"Okej, f\u00e5r se om den h\u00e4r fungerar. Hmm...",en:"Ok, let's see if this works. Hmm..."},FISHING_CATCH_NUMBER:{sv:"F\u00e5nga nummer %1",en:"Catch number %1"},FISHING_CATCH:{sv:"F\u00e5nga",en:"Catch"},FISHING_FREE_WRONG_ONES:{sv:"Frige fiskarna som \u00e4r fel",en:"Put back the wrong fish"},FISHING_NOT_THIS_ONE:{sv:"Inte den!",
en:"Not this one!"},FISHING_THERE_ARE_MORE:{sv:"Det finns mer fiskar att f\u00e5nga. Forts\u00e4tt leta!",en:"There are more fish to catch. Keep looking!"},FISHING_ARE_YOU_SURE:{sv:"\u00c4r du s\u00e4ker?",en:"Are you sure?"},FISHING_COUNT_FISH:{sv:"R\u00e4kna fiskarna!",en:"Count the fish!"},FISHING_COUNT_TARGET_FISH:{sv:"R\u00e4kna fiskarna med",en:"Count the fish with"},FISHING_ANGEL_CHOOSE_FISH:{sv:"Jag v\u00e4ljer den h\u00e4r fisken eftersom...",en:"I choose this fish, because it..."},FISHING_ANGEL_COUNT:{sv:"Jag v\u00e4ljer den h\u00e4r siffran eftersom...",
en:"I choose this number, because..."},LADDER_LOOKS_FUN:{sv:"Det d\u00e4r s\u00e5g kul ut!",en:"That looked fun!"},LADDER_SHOW_ME:{sv:"Visa mig hur man g\u00f6r!",en:"Now show me how to do it!"},LADDER_MY_TURN:{sv:"Okej, nu ska vi se om jag klarar det h\u00e4r sj\u00e4lv!",en:"Ok, now let's see if I can do this on my own!"},LADDER_IS_IT_RIGHT:{sv:"G\u00f6r jag r\u00e4tt eller fel?",en:"Am I doing it right or wrong?"},LADDER_IT_WAS_RIGHT:{sv:"Ja! Du fick presenten!",en:"Yeah! You got it!"},LADDER_TREE_OOPS_TOO_HIGH:{sv:"Oj, kanske tog vi i f\u00f6r mycket!",
en:"Oops! Maybe we overdid it!"},LADDER_TREE_OOPS_TOO_LOW:{sv:"Hmm... Kanske var det inte tillr\u00e4ckligt!",en:"Hmm... Maybe it wasn't enough!"},LADDER_TREE_TRY_A_SMALLER_NUMBER:{sv:"Vi kan v\u00e4l testa en mindre och se vad som h\u00e4nder!",en:"Let's try a smaller one and see what happens!"},LADDER_TREE_TRY_A_BIGGER_NUMBER:{sv:"Vad tror du? Ska vi testa en st\u00f6rre?",en:"What do you think? Shall we try a bigger one?"},LADDER_TREE_AGENT_PLAY_TOO_LOW:{sv:"Hmm, det gick inte. Jag undrar varf\u00f6r. Jag testar en st\u00f6rre!",
en:"Hmm, that didn't work. I wonder why. Let me try a bigger one!"},LADDER_TREE_AGENT_PLAY_TOO_HIGH:{sv:"\u00c5h, nej! Var den f\u00f6r stor?",en:"Oh no! Was that too big?"},LADDER_TREE_AGENT_SEE_CORRECT:{sv:"WOO! Tack f\u00f6r hj\u00e4lpen! Vilken fin present!",en:"WOO! Thank you for helping me! What a great surprise!"},LADDER_TREE_AGENT_SUGGEST_SOLUTION_1:{sv:"Kanske kan vi f\u00f6rs\u00f6ka med samma siffra p\u00e5",en:"Maybe we should match the number on"},LADDER_TREE_AGENT_SUGGEST_SOLUTION_2:{sv:"nummerplattan som vid presenten?",
en:"the number pad to the number by the gift?"},LADDER_PLEASE_HELP_ME:{sv:"Kan du hj\u00e4lpa mig att v\u00e4lja r\u00e4tt?",en:"Can you please help me find the right one?"},LADDER_MOUNTAIN_IM_DOWN_HERE:{sv:"Jag \u00e4r h\u00e4r nere!",en:"I'm down here!"},LADDER_MOUNTAIN_IM_UP_HERE:{sv:"Jag \u00e4r h\u00e4r uppe!",en:"I'm up here!"},LADDER_MOUNTAIN_YOU_SAVED_ME:{sv:"Du r\u00e4ddade mig!!!",en:"You saved me!!!"},LADDER_MOUNTAIN_IM_HUNGRY:{sv:"Jag \u00e4r hungrig. Kom s\u00e5 g\u00e5r vi och \u00e4ter!",
en:"I'm hungry. Let's go eat!"},LADDER_MOUNTAIN_TRY_FEWER_BALLOONS:{sv:"Kanske ska vi testa med f\u00e4rre ballonger?",en:"Perhaps we should try with fewer balloons?"},LADDER_MOUNTAIN_TRY_MORE_BALLOONS:{sv:"Vi kan v\u00e4l testa med fler ballonger och se vad som h\u00e4nder?",en:"Let's try with more balloons and see what happens!"},LADDER_MOUNTAIN_AGENT_SUGGEST_SOLUTION_1:{sv:"Kanske kan vi f\u00f6rs\u00f6ka med lika m\u00e5nga ballonger",en:"Maybe we should match the number of balloons"},LADDER_MOUNTAIN_AGENT_SUGGEST_SOLUTION_2:{sv:"som niv\u00e5er upp din v\u00e4n \u00e4r.",
en:"to the level your friend is stuck on."},LADDER_MOUNTAIN_AGENT_PLAY_TOO_LOW:{sv:"Oj, det kanske var f\u00f6r f\u00e5 ballonger.",en:"Oops, maybe I used to few balloons."},LADDER_MOUNTAIN_AGENT_PLAY_TOO_HIGH:{sv:"Hoppsan, det var nog f\u00f6r m\u00e5nga ballonger!",en:"Oops, I think there were too many balloons!"},LADDER_MOUNTAIN_BETTER_BECAUSE_BIGGER:{sv:"Ja, det fungerar nog, f\u00f6r det \u00c4R fler ballonger!",en:"Yes, this can work, beacuse that IS more ballons!"},LADDER_MOUNTAIN_BETTER_BECAUSE_SMALLER:{sv:"Ja, det fungerar nog, f\u00f6r det \u00c4R f\u00e4rre ballonger!",
en:"Yes, this will probably work, beacuse that IS fewer balloons!"},LADDER_MOUNTAIN_AGENT_SEE_CORRECT:{sv:"WOO! Tack f\u00f6r hj\u00e4lpen! Vi r\u00e4ddade v\u00e5r v\u00e4n!",en:"WOO! Thank you for helping me! We saved our friend!"},BUBBA_HI:{sv:"Hej! Mitt namn \u00e4r Bubba!",en:"Hi, my name is Bubba!"},BUBBA_HERE_TO_HELP:{sv:"Jag ska hj\u00e4lpa dig och apan l\u00e4ngs v\u00e4gen.",en:"I'm here to help you and monkey throughout his journey."},MONKEY_LEARNED_WELL:{sv:"Toppen! Apan l\u00e4rde sig bra!",
en:"Great! Monkey learned well!"},MONKEY_DIDNT_LEARN_WELL:{sv:"\u00c5h, nej! Apan l\u00e4rde sig inte riktigt.",en:"Oh no! Monkey didn't learn well."},LETS_SHOW_HIM_AGAIN:{sv:"Visa honom igen!",en:"Let's show him again!"},THANK_YOU_FOR_HELPING:{sv:"Tack f\u00f6r att du hj\u00e4lpte apan!",en:"Thank you for helping monkey!"},NOW_MONKEY_SHOW_YOU:{sv:"Nu visar apan dig vad den har l\u00e4rt sig!",en:"Now monkey show you what it learned!"},MONKEYS_TURN:{sv:"Apans tur!",en:"Monkey's turn!"},MONKEY_HMM:{sv:"Apan: Hmmm...",
en:"Monkey: Hmm..."},FISHING_KEEP_GOING:{sv:"Forts\u00e4tt!",en:"Keep going!"},NUMBER_1:{sv:"nummer 1",en:"number 1"},NUMBER_2:{sv:"nummer 2",en:"number 2"},NUMBER_3:{sv:"nummer 3",en:"number 3"},NUMBER_4:{sv:"nummer 4",en:"number 4"},NUMBER_5:{sv:"nummer 5",en:"number 5"},NUMBER_6:{sv:"nummer 6",en:"number 6"},NUMBER_7:{sv:"nummer 7",en:"number 7"},NUMBER_8:{sv:"nummer 8",en:"number 8"},NUMBER_9:{sv:"nummer 9",en:"number 9"},NUMBER_10:{sv:"nummer 10",en:"number 10"},SETTINGS_LABEL:{sv:"Inst\u00e4llningar",
en:"Settings"},SETTINGS_APPLY:{sv:"Verkst\u00e4ll",en:"Apply"},SETTINGS_SHOW:{sv:"Visa inst\u00e4llningar",en:"Show settings"},SETTINGS_HIDE:{sv:"G\u00f6m inst\u00e4llningar",en:"Hide settings"},SETTINGS_CANCEL:{sv:"Avbryt",en:"Cancel"},SETTINGS_GLOBAL_LABEL:{sv:"Globala",en:"Global"},SETTINGS_GLOBAL_LANGUAGE_LABEL:{sv:'Spr\u00e5k (kan vara "sv" eller "en" och kr\u00e4ver omstart)',en:'Language (can be "sv" or "en" and requires restart)'},SETTINGS_GLOBAL_MONKEYSEEROUNDS_LABEL:{sv:"Monkey See-rundor",
en:"Monkey See rounds"},SETTINGS_GLOBAL_TRIESBEFOREGUARDIANANGEL_LABEL:{sv:"F\u00f6rs\u00f6k innan skydds\u00e4ngel",en:"Tries before guardian angel"},SETTINGS_MINIGAMES_LABEL:{sv:"Minispel",en:"Mini-games"},SETTINGS_MINIGAMES_FISHINGGAME_LABEL:{sv:"Fiskespel",en:"Fishing Game"},SETTINGS_MINIGAMES_FISHINGGAME_TARGETNUMBER_LABEL:{sv:"M\u00e5lnummer",en:"Target number"},SETTINGS_MINIGAMES_FISHINGGAME_NUMBERCORRECT_LABEL:{sv:"Antal korrekta fiskar",en:"Number of correct fish"},SETTINGS_MINIGAMES_FISHINGGAME_NUMBEROFFISH_LABEL:{sv:"Antal fiskar totalt",
en:"Number of fish totally"},SETTINGS_MINIGAMES_FISHINGGAME_MAXNUMBER_LABEL:{sv:"H\u00f6gsta m\u00f6jliga nummer",en:"Maximum number on fish"},SETTINGS_MINIGAMES_LADDER_LABEL:{sv:"Stegen",en:"The Ladder"},SETTINGS_MINIGAMES_LADDER_TARGETNUMBER_LABEL:{sv:"M\u00e5lnummer",en:"Target number"}};return{get:function(a,b){if(c[a]===g)return o;for(var f=c[a][S.get("global","language")],e=1;e<arguments.length;e++)f=f.replace("%"+e,arguments[e]);return f}}}();
function pa(){this.w("GamerPlayer");s.debug("Creating GamerPlayer","player");this.u=q();this.u.Ladder=q()}pa.prototype=new U;
function qa(){s.debug("Creating MonkeyPlayer","player");var c=this;this.u=q();this.u.Ladder=function(a,b){function f(c){d||(k++,setTimeout(function(){s.debug("Picking a number","agent");c===h||"incorrect"===b[c]?a.n(a.na()):a.n(a.L())},2E3))}s.debug("Applying MonkeyPlayer's strategy to the Ladder","player");var e=0,d=p,h=W.C(0,b.length-1);s.debug("Will make mistake on try number "+h+1,"agent");var k=0;c.on("Ladder.readyToPick",function(){f(e++)});c.on("Ladder.incorrect",function(){a.j()||(4>k?f(e++):
4===k&&!a.f()&&(R.play(Ka),a.Wa()))});c.on("Ladder.correct",function(){k=0});this.G=function(){s.debug("Interrupting agent","agent");d=i;k=0};this.fb=function(){s.debug("Resuming agent","agent");d=p};c.on("Ladder.hasTarget",function(){setTimeout(function(){a.O()},1500)});c.on("Game.stopMiniGame",function(){c.m()})}}qa.prototype=new U;
function wa(c){function a(a,b,f){var j=new Kinetic.Group({x:b,y:f}),b=new Kinetic.Rect({width:250,height:250,fill:{start:{x:125,y:125,radius:0},end:{x:125,y:125,radius:187.5},colorStops:[0,"#00FF7F",1,"#556B2F"]},shadow:{color:"black",blur:15,offset:[15,15],alpha:0.5},alpha:0.6,cornerRadius:10,strokeWidth:4,stroke:"white",centerOffset:{x:125,y:125}});j.add(b);j.h=b;j.Ka=a;a=new Kinetic.Image({image:a,centerOffset:{x:a.width/2,y:a.height/2}});j.add(a);j.on("mousedown touchstart",function(){R.play(Aa);
j.h.setFill("white");j.moveToTop();e.Pa(j,function(){c.Qa(j.Ka)});e.Ra()});return j}J.call(this);this.w("AgentChooserView");var b=this,f=o,e=function(){var a=[];this.add=function(b){a.push(b);f.add(b)};this.Ra=function(){for(var b=0;b<a.length;b++)a[b].attrs.listening=p};this.Pa=function(c,e){for(var f=0;f<a.length;f++)a[f]===c?(b.c(a[f].attrs).wait(1E3).to({x:b.d.getWidth()/2,y:b.d.getHeight()/2},1E3),b.c(a[f].attrs.scale).wait(1E3).to({x:1.5,y:1.5},1E3).call(function(){R.play(Ca)}).wait(5E3).call(e)):
b.c(a[f].attrs).to({alpha:0},1E3)};return this}();b.H=function(){f=new Kinetic.Layer;b.d.add(f);var d=new Kinetic.Image({image:X.Ga});f.add(d);for(var d=W.F(363,230,310,310),h=c.Ta(),k=0;k<h.length;k++){var j=d.next();e.add(new a(h[k],j.x,j.y))}};b.on(L,function(){b.m();b.d.remove(f)});b.on("frame",function(){f.draw()})}G(wa,J);
function Z(c,a){H.call(this);this.w(c);s.debug("Creating LadderView","object");var b=this,f=o,e=o,d=o,h=o,k={x:800,y:650};this.da=function(a){f=new Kinetic.Image({image:X.Ja,x:750,y:700,centerOffset:{x:64,y:64},alpha:0});e=new Kinetic.Image({image:X.Ia,x:900,y:700,centerOffset:{x:64,y:64},alpha:0});a.add(f);a.add(e)};this.ca=function(a,c,e){d=new Kinetic.Image({image:b.A,x:b.getStage().getWidth()+10,y:c});e.add(d);if(b.b.bb()){var f=function(){b.setTimeout(function(){b.c(d.attrs).to({x:b.getStage().getWidth()-
100,rotation:-Math.PI/5},1E3).wait(2E3).to({x:b.getStage().getWidth()+10},1E3).call(function(){f()})},2E3)};f()}else(b.b.r()||b.b.g())&&d.setX(a);b.b.g()&&(h=new Kinetic.Line({points:[660,570,k.x,k.y],stroke:"brown",strokeWidth:2,lineCap:"round"}),e.add(h))};b.on("Ladder.interrupt",function(){b.b.g()&&(b.t(h.attrs.points[1]),b.c(h.attrs.points[1]).to(k,1E3).call(function(){R.play(Ga)}));b.G()});b.on("Ladder.introduceAgent",function(a){R.play(Ha);b.setTimeout(function(){R.play(Ia);b.setTimeout(function(){a.callback()},
2E3)},2E3)});b.on("Ladder.allowInterrupt",function(c){f.on("mousedown touchstart",function(){b.c(f.attrs).to({rotation:8*Math.PI},1200).to({rotation:0});R.play(ya);a.M()});e.on("mousedown touchstart",function(){b.c(e.attrs).to({rotation:8*Math.PI},1200).to({rotation:0});R.play(za)});c.callback()});b.on("Ladder.disallowInterrupt",function(){f.off("mousedown touchstart");e.off("mousedown touchstart")});b.on("Ladder.startAgent",function(a){R.play(Ja);b.setTimeout(function(){a.callback();b.c(f.attrs).to({alpha:1},
1E3);b.c(e.attrs).to({alpha:1},1E3)},2E3)});b.on("Ladder.cheer",function(a){b.mb();b.setTimeout(a.callback,1500)});b.on("Ladder.confirmTarget",function(a){b.b.r()&&R.play(b.ea);b.ka(a)});b.on("Ladder.betterBecauseBigger",function(){R.play(b.ia)});b.on("Ladder.betterBecauseSmaller",function(){R.play(b.ja)});b.on("Ladder.hmm",function(){R.play(Fa)});b.on("Ladder.agentSuggestSolution",function(){b.setTimeout(function(){R.play(b.T);b.setTimeout(function(){R.play(b.T)},2E3)},2E3)});b.on("Ladder.tooLow",
function(){R.play(b.ya);setTimeout(function(){R.play(b.za)},2E3)});b.on("Ladder.tooHigh",function(){R.play(b.xa);setTimeout(function(){R.play(b.Aa)},2E3)});b.on("Ladder.agentTooLow",function(){R.play(b.ga)});b.on("Ladder.agentTooHigh",function(){R.play(b.fa)});b.on("Ladder.picked",function(c){if(b.b.g()&&!a.j()&&!a.f()){var d=b.oa(c.o);R.play(Ea);b.c(h.attrs.points[1]).wait(1500).to(d,3E3).wait(3E3).call(function(){b.n(c.o,c.callback)}).wait(1E3).to(k,1E3)}else b.n(c.o,c.callback)})}G(Z,H);
function ta(c){var a=this;Z.call(this,"MtView",c);s.debug("Constructing MountainView",this.i);a.ya=Xa;a.xa=Wa;a.za=Za;a.Aa=Ya;a.T=$a;a.ob=ab;a.ga=db;a.fa=eb;a.ia=bb;a.ja=cb;a.ea=fb;var b=p,f=o,e=p,d=new Kinetic.Layer,h=new Kinetic.Layer,k=[],j=new Kinetic.Group({x:400,y:600}),n=new Kinetic.Rect({width:50,height:50,fill:"blue",stroke:"black",strokeWidth:4,centerOffset:{x:25,y:50}});Kinetic.Da=function(a,b){var c=new Kinetic.Group({x:a,y:b}),d=new Kinetic.Circle({fill:"red",stroke:"black",strokeWidth:4,
radius:20}),e=new Kinetic.Line({stroke:"black",strokeWidth:4,points:[0,20,0,65]});c.add(e);c.add(d);return c};a.H=function(){s.debug("Setting up MountainView","mt-view");a.d.add(h);a.d.add(d);var f=new Kinetic.Polygon({points:[50,600,350,600,150,100],fill:"gray",stroke:"black",strokeWidth:4});j.add(new Kinetic.Polygon({points:[0,0,100,0,110,-50,-10,-50],fill:"#993300",stroke:"black",strokeWidth:4}));for(var l=new W.F(730,180,140,140),u=0;6>u;u++)(function(f){var h=l.next(),h=new Kinetic.Group({x:h.x,
y:h.y}),j=new Kinetic.Group({x:40,y:40}),m=new Kinetic.Rect({width:140,height:140,fill:"yellow",strokeWidth:4,stroke:"black"});h.add(m);k.push(h);for(var n=0,u=0;u<=f;u++)3===u&&n++,j.add(new Kinetic.Da(30*u-81*n,30*n));h.add(j);h.h=m;h.Z=j;h.on("mousedown touchstart",function(){b&&a.b.sa()?(b=p,c.n(f+1)):a.b.P()&&!e&&(e=i,R.play(Ba),setTimeout(function(){R.play(Da);setTimeout(function(){e=p},2E3)},2E3))});d.add(h)})(u);h.add(f);f=c.B();for(u=0;u<f.length;u++){var w=new Kinetic.Line({points:[280-
24*u,430-60*u,280-24*u+100,430-60*u],stroke:"black",strokeWidth:4});h.add(w)}n.hide();d.add(n);d.add(j);a.on("frame",function(){d.draw()});a.da(d);a.ca(a.getStage().getWidth()-500,430,d);h.draw()};a.G=function(){f();a.t(j.attrs);a.c(j.attrs).to({x:400,y:600})};a.on("Ladder.placeTarget",function(a){var d=c.L()-1;n.setX(280-24*d);n.setY(430-60*d);n.show();b=i;a.callback()});this.oa=function(a){a=k[a-1];return{x:a.getX()+a.h.getWidth()/2,y:a.getY()+a.h.getHeight()/2}};this.n=function(b,c){var d=k[b-
1].Z,e=k[b-1];e.h.setFill("red");var h=e.Z.getX(),l=d.getY();f=function(){a.t(d.attrs);d.setX(h);d.setY(l);d.moveTo(e);e.h.setFill("yellow")};a.c(d.attrs).to({x:-Math.abs(400-e.getX())+20,y:600-e.getY()+-110},4E3).call(function(){d.moveTo(j);d.setX(20);d.setY(-110);d.moveDown();c()})};a.on("Ladder.approachLadder",function(b){a.c(j.attrs).to({x:280-24*(b.o-1)+100,y:430-60*(b.o-1)},2E3).call(b.callback)});a.on("Ladder.getTarget",function(b){R.play(gb);a.setTimeout(function(){R.play(hb)},2E3);a.c(n.attrs).to({x:j.getX()+
50,y:j.getY()+-25},1E3).call(function(){a.c(j.attrs).to({x:400,y:600},3E3);a.c(n.attrs).to({x:450,y:575},3E3).call(function(){a.c(n.attrs).to({x:550,y:600},2E3).call(b.callback)})})});a.on("Ladder.hasTarget",function(){a.b.g()||c.O()});a.ka=function(a){a.callback()};a.on("Ladder.resetScene",function(c){function d(){f!=o&&f();c.K&&(b=i);c.callback()}600!=j.getY()?a.c(j.attrs).to({x:400,y:600},2E3).call(d):d()});var l=a.l;a.l=function(){l();s.debug("Tearing down MountainView",this.i);a.d.remove(h);
a.d.remove(d)}}G(ta,Z);
function ra(c){function a(){v.on("mousedown touchstart",function(){c.O()})}function b(){var a=v.getX(),c=v.getY();e.c(v.attrs).to({x:a-5},100).to({x:a+5},100).to({x:a-5},100).to({x:a+5},100).to({x:a-5},100).to({x:a+5},100).to({x:a-5},100).to({x:a+5},100).to({x:a-5},100).to({x:a},100);e.c(v.attrs).to({y:c-5},100).to({y:c+5},100).to({y:c-5},100).to({y:c+5},100).to({y:c-5},100).to({y:c+5},100).to({y:c-5},100).to({y:c+5},100).to({y:c-5},100).to({y:c},100).wait(4E3).call(function(){b()})}function f(a){a===
g&&(a=1);e.c(C.attrs.scale).to({y:-1*a},500).call(function(){N&&f(-1*a)})}var e=this;Z.call(this,"TreeView",c);s.debug("Creating TreeView","object");e.ya=Ma;e.xa=La;e.za=Oa;e.Aa=Na;e.T=Pa;e.ob=Qa;e.ga=Ta;e.fa=Ua;e.ia=Ra;e.ja=Sa;e.ea=Va;var d=0.4*e.getStage().getWidth(),h=0.45*e.getStage().getWidth(),k=p,j=o,n=new Kinetic.Layer,l=new Kinetic.Layer;e.getStage().add(n);e.getStage().add(l);var m=e.getStage().getHeight()-100-90,F=e.getStage().getHeight()-100-80,u=0,w={},I={},D=new Kinetic.Group({x:790,
y:130}),t=new Kinetic.Circle({radius:50,fill:"blue"}),x=new Kinetic.Image({image:X.W,width:30,height:30,x:-50,y:-40}),A=new Kinetic.Image({image:X.W,width:30,height:30,x:-30,y:-40}),K=new Kinetic.Shape({drawFunc:function(){var a=this.getContext();a.beginPath();a.moveTo(-48,-20);a.quadraticCurveTo(-68,-30,-78,-10);a.quadraticCurveTo(-48,-10,-48,0);a.closePath();this.fill();this.stroke()},fill:"#FFD700",stroke:"#DAA520",strokeWidth:4}),C=new Kinetic.Shape({drawFunc:function(){var a=this.getContext();
a.beginPath();a.moveTo(0,0);a.moveTo(30,0);a.quadraticCurveTo(40,80,50,100);a.quadraticCurveTo(40,80,0,0);a.closePath();this.fill()},fill:"#FFD700",stroke:"#DAA520",strokeWidth:4});C.attrs.scale.y=0.2;D.add(t);D.add(K);D.add(x);D.add(A);D.add(C);var t=new Kinetic.Image({image:X.Ca,x:700,y:130,width:180,height:130}),N=i,M={start:{x:-50,y:-50},end:{x:50,y:50},colorStops:[0,"red",1,"yellow"]},v=o;e.ka=function(a){v.off("mousedown touchstart");e.t(v.attrs);v.Ma.setFill("blue");j.h.attrs.fill=M;n.draw();
var b=new Kinetic.Image({x:v.getX()+128,y:v.getY(),image:X.Ba,width:128,height:128,centerOffset:{x:64,y:64},scale:{x:0.1,y:0.1}});l.add(b);e.c(b.attrs.scale).to({x:1,y:1},500).call(function(){e.c(b.attrs).to({y:100},2E3).call(a.callback)})};e.on("Ladder.placeTarget",function(a){u++;a=a.callback;v=new Kinetic.Group({x:130,y:200});var b=new Kinetic.Circle({x:100,y:45,radius:35,fill:"red",stroke:"#440000",strokeWidth:4});v.Ma=b;v.add(b);e.c(v.attrs).to({y:I[c.L()].getY()},1E3).call(a);l.add(v);k=i});
this.n=function(a,b){R.play(Aa);w[a].h.Ec=w[a].h.attrs.fill;w[a].h.setFill("red");j=w[a];n.draw();b()};this.oa=function(a){console.log(a);return{x:w[a].getX(),y:w[a].getY()}};e.on("Ladder.approachLadder",function(a){N=i;f();e.c(D.attrs).to({x:300,y:I[a.o].getY()},5500).call(a.callback)});e.on("Ladder.resetScene",function(a){e.c(D.attrs).to({x:790,y:130},3E3).call(function(){j!=o&&(j.h.attrs.fill=M,n.draw());a.K&&(k=i);N=p;e.c(C.attrs.scale).to({y:0.2},500);a.callback()})});e.on("Ladder.getTarget",
function(c){var d={x:650+75*u,y:F-200},f={x:d.x,y:d.y};d.x+=170;e.c(D.attrs).to(d,2E3).call(function(){e.c(v.attrs).to({x:650+75*u,y:F},500).call(function(){e.b.g()||(a(),b())})});e.c(v.attrs).to(f,2E3).call(function(){c.callback()})});e.on("frame",function(){l.draw()});e.l=function(){s.debug("Tearing down",this.i);e.getStage().remove(n);e.getStage().remove(l)};e.G=function(){console.log("interrupt!");e.t(D.attrs)};e.H=q();x=new Kinetic.Rect({fill:{start:{x:0,y:0},end:{x:e.getStage().getWidth(),y:e.getStage().getHeight()},
colorStops:[0,"#87CEFA",0.6,"#87CEFA",1,"#6A5ACD"]},x:0,y:0,width:e.getStage().getWidth(),height:e.getStage().getHeight()});A=new Kinetic.Shape({drawFunc:function(){var a=this.getContext();a.beginPath();a.moveTo(0,e.getStage().getHeight()-100);a.lineTo(d,e.getStage().getHeight()-100);a.quadraticCurveTo(d-80,e.getStage().getHeight()-80,d-100,e.getStage().getHeight());a.lineTo(0,e.getStage().getHeight());a.closePath();this.fill();this.stroke()},fill:"#F4A460",stroke:"#A52A2A",strokeWidth:4});K=new Kinetic.Shape({drawFunc:function(){var a=
this.getContext();a.beginPath();a.moveTo(e.getStage().getWidth(),e.getStage().getHeight()-100);a.lineTo(e.getStage().getWidth()-h,e.getStage().getHeight()-100);a.quadraticCurveTo(e.getStage().getWidth()-h+80,e.getStage().getHeight()-80,e.getStage().getWidth()-h+100,e.getStage().getHeight());a.lineTo(e.getStage().getWidth(),e.getStage().getHeight());a.closePath();this.fill();this.stroke()},fill:"#F4A460",stroke:"#A52A2A",strokeWidth:4});n.add(x);n.add(A);n.add(K);n.add(t);e.da(l);e.on("Ladder.helpAgent",
function(){k=i});for(t=0;t<c.B().length;t++){var x=c.B()[t],A=m,A=A-90*t,A=new Kinetic.Group({x:130,y:A}),K=new Kinetic.Polygon({points:[0,0,120,0,110,90,10,90],fill:"#A52A2A",stroke:"#5C4033",strokeWidth:5}),T=new Kinetic.Text({text:x,y:45,x:15,height:90,fontSize:56,fontFamily:"Doppio One",textFill:"white",verticalAlign:"middle",textStroke:"#5C4033",textStrokeWidth:2});A.add(K);A.add(T);I[x]=A;n.add(A)}var y=m-90*(c.B().length-1),m=new Kinetic.Shape({drawFunc:function(){var a=this.getContext();a.beginPath();
a.moveTo(200,y);a.bezierCurveTo(150,y-60,100,y-90,-50,y+80);a.bezierCurveTo(130,y-20,150,y-30,190,y+10);a.bezierCurveTo(150,y-60,100,y-150,-50,y-180);a.bezierCurveTo(130,y-150,150,y-60,190,y-10);a.bezierCurveTo(250,y-60,300,y-90,450,y+80);a.bezierCurveTo(270,y-20,250,y-30,210,y+10);a.closePath();this.fill();this.stroke()},fill:"#556B2F",stroke:"#006400",strokeWidth:4});n.add(m);l.add(D);for(var jb=W.F(724,300,120,120),aa=p,t=1;6>=t;t++)(function(a){var b=jb.next(),b=new Kinetic.Group(b),d=new Kinetic.Rect({width:100,
height:100,fill:M,cornerRadius:10,strokeWidth:4,stroke:"orange",centerOffset:{x:50,y:50}});b.add(d);b.h=d;d=new Kinetic.Text({text:a,fontSize:60,fontFamily:"Nunito",textFill:"orange",verticalAlign:"middle",align:"center",textStroke:"red",textStrokeWidth:1,x:50,y:50,centerOffset:{x:50,y:50}});b.Gc=d;b.add(d);b.on("mousedown touchstart",function(){k&&e.b.sa()?(k=p,c.n(a)):e.b.P()&&!aa&&(aa=i,R.play(Ba),setTimeout(function(){R.play(Da);setTimeout(function(){aa=p},2E3)},2E3))});w[a]=b;n.add(b)})(t);e.ca(e.getStage().getWidth()-
500,e.getStage().getHeight()-100-e.A.height,l);n.draw()}G(ra,Z);
function va(){J.call(this);var c=this.d.p;this.w("MinigameHandlerView");var a=new Kinetic.Text({text:"Backend Score (current minigame):",fontSize:16,fontFamily:"sans-serif",textFill:"black",align:"left",verticalAlign:"middle",x:this.d.getWidth()-500,y:35});this.on("backendScoreGameUpdateMiniGame",function(b){a.setText("Backend Score (current minigame): "+b.ib)});this.on("miniGameInitiated",function(){c.add(a)});this.on("miniGameDone",function(){c.remove(a)});(function(a){var f=new Kinetic.Text({text:"Learning track (current game):",
fontSize:16,fontFamily:"sans-serif",textFill:"black",align:"left",verticalAlign:"middle",x:a.d.getWidth()-500,y:55});a.on("miniGameInitiated",function(){c.add(f)});a.on("learningTrackUpdate",function(a){f.setText("Learning track (current game): "+a.$a.name())});a.on(L,function(){c.remove(f)})})(this)}G(va,J);
function ua(){var c=this.d;J.call(this);this.i="MonkeyWorldView";var a=c.p;this.l=function(){this.m()};(function(b){var c=[];b.on("Game.showMiniGameChooser",function(b){var d=b.callback,h=b.Sa,k=W.F(200,200,300,100),j;for(j in h)(function(){var b=h[j],e=k.next(),e=new Kinetic.Group(e),m=new Kinetic.Rect({width:280,height:100,stroke:"black",strokeWidth:4}),F=new Kinetic.Text({text:b.title,fontSize:20,fontFamily:"sans-serif",textFill:"black",align:"center",verticalAlign:"middle",x:m.getWidth()/2,y:m.getHeight()/
2});e.add(m);e.add(F);e.on("mousedown touchstart",function(){m.setFill("yellow");d(b)});c.push(e);a.add(e)})()});b.on("Game.hideMiniGameChooser",function(){for(var b=0;b<c.length;b++)a.remove(c[b]);c=[]})})(this);(function(b){var f=new Kinetic.Rect({x:c.getWidth()/2,y:c.getHeight()/2,width:320,height:50,cornerRadius:10,centerOffset:{x:160,y:25},fill:"#333",alpha:0}),e=new Kinetic.Rect({x:c.getWidth()/2,y:c.getHeight()/2,width:0,height:30,centerOffset:{x:150,y:15},fill:"#FFCC00"}),d=new Kinetic.Text({fontFamily:"Arial",
fontSize:10,textFill:"black",fontStyle:"bold",Mc:"black",text:"Monkey World Demo",align:"center",y:c.getHeight()/2-50,x:c.getWidth()/2});b.on("Game.showLoadingScreen",function(b){a.add(f);a.add(e);a.add(d);f.transitionTo({alpha:1,duration:b.time/1E3})});b.on("Game.loadingSounds",function(){d.setText(V.get("INIT_LOADING_SOUNDS"))});b.on("Game.loadingImages",function(){d.setText(V.get("INIT_LOADING_IMAGES"))});b.on("Game.loadingDone",function(){a.remove(d);a.remove(f);a.remove(e)});b.on("Game.updateSoundLoading",
function(a){e.setWidth(300*a.progress)});b.on("Game.updateImageLoading",function(a){e.setWidth(300*a.progress)})})(this)}G(ua,J);